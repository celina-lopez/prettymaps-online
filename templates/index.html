{% extends "layout.html" %}
{% block body %}

<div class="container py-5 mb-3 content" x-data="{}">
  <div class="text-end mb-4">
    <div style="font-size: 2em; cursor: pointer;" x-on:click="location.href='https://github.com/czhu12/forever-free-cloud-app-starter'">
      <i class="fab fa-github"></i>
    </div>
  </div>
  <div class="text-center mb-4">
    <div class="h1 text-center fancy-font">
      PRETTYMAPS <span class="text-main">ONLINE</span>
    </div>
    <i>Made with prettymaps + forever free cloud app starter</i>
  </div>
  <p>
  {{ readme | safe }}
  </p>

  <div class="d-grid gap-2">
  
    <div class="row">
      <div class="col-md-6">
        <label for="xCoord">x</label>
        <input type="number" name="x" step="any" class="form-control" id="x" placeholder="37.7767135">
      </div>
      <div class="col-md-6">
        <label for="yCoord">y</label>
        <input type="number" name="y" step="any" class="form-control" id="y" placeholder="-122.4353989">
      </div>
    </div>
      <label for="mapName">title</label>
      <input type="text" name="name" class="form-control" id="mapName" placeholder="Painted Ladies">

      <label for="theme">
        theme
        <a href="/examples">
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 302.967 302.967" style="height: 20px" xml:space="preserve">
            <g>
              <g>
                <g>
                  <path style="fill:#010002;" d="M151.483,302.967C67.956,302.967,0,235.017,0,151.483S67.956,0,151.483,0     s151.483,67.956,151.483,151.483S235.017,302.967,151.483,302.967z M151.483,24.416c-70.066,0-127.067,57.001-127.067,127.067     s57.001,127.067,127.067,127.067s127.067-57.001,127.067-127.067S221.555,24.416,151.483,24.416z"/>
                </g>
                <g>
                  <g>
                    <path style="fill:#010002;" d="M116.586,118.12c1.795-4.607,4.297-8.588,7.511-11.961c3.225-3.389,7.114-6.016,11.667-7.898      c4.547-1.904,9.633-2.845,15.262-2.845c7.261,0,13.32,0.995,18.183,2.997c4.857,1.996,8.768,4.482,11.738,7.441      c2.964,2.97,5.091,6.168,6.369,9.584c1.273,3.432,1.915,6.636,1.915,9.595c0,4.901-0.642,8.947-1.915,12.118      c-1.278,3.171-2.866,5.88-4.759,8.131c-1.898,2.252-3.987,4.172-6.293,5.755c-2.295,1.588-4.471,3.171-6.516,4.759      c-2.045,1.583-3.862,3.394-5.445,5.439c-1.588,2.04-2.589,4.601-2.991,7.664v5.831H140.6v-6.908      c0.305-4.395,1.153-8.072,2.529-11.036c1.382-2.964,2.991-5.499,4.83-7.598c1.844-2.089,3.786-3.911,5.836-5.445      c2.04-1.539,3.927-3.073,5.673-4.591c1.73-1.545,3.144-3.225,4.221-5.069c1.071-1.833,1.556-4.15,1.452-6.908      c0-4.705-1.148-8.18-3.454-10.427c-2.295-2.257-5.493-3.378-9.589-3.378c-2.758,0-5.134,0.533-7.131,1.605      s-3.628,2.513-4.911,4.302c-1.278,1.795-2.225,3.894-2.834,6.288c-0.615,2.415-0.919,4.982-0.919,7.756h-22.55      C113.85,127.785,114.791,122.732,116.586,118.12z M162.536,183.938v23.616h-24.09v-23.616H162.536z"/>
                  </g>
                </g>
              </g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            <g>
            </g>
            </svg>
        </a>
      </label>
      <select class="form-control" id="theme_num" name="theme_num">
        <option selected value="0">kawaii pink</option>
        <option value="1">lemoncello yellow</option>
        <option value="2">blue dabadi daba</option>
        <option value="3">cafe dream</option>
        <option value="4">yellowgreen!</option>
        <option value="5">grape soda</option>
      </select>
      <button id="urlSubmit" class="btn btn-main btn-lg btn-block">
        Generate Image
      </button>
    <div class="row justify-content-center mt-3">
      <div class="col-auto">
        <div id="display" style="max-width: 500px;">
          <img src="" id="imgHere" width="500" class="rounded" />
          <div class="d-flex justify-content-center">
            <div class="spinner-border d-none" id="imageSpinner" role="status">
              <span class="sr-only">Loading...</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="footer-copyright text-center py-3">
  <i>This was built with <a target="_blank" href="https://forever-free-cloud-app-starter.chriszhu.me/">Forever-Free Cloud App Starter</a></i>
</div>

<script>
  document.getElementById("urlSubmit").addEventListener("click", function () {
    document.getElementById("imageSpinner").setAttribute("class", "spinner-border")
    let request = new XMLHttpRequest();
    queryString = "?name=" + document.getElementById("mapName").value + "&x=" + document.getElementById("x").value + "&y=" + document.getElementById("y").value + "&theme_num=" + document.getElementById("theme_num").value
    request.open('GET', "/api" + queryString);
    request.responseType = 'text';
    request.onload = function() {
      const text = request.response.slice(1, -1);
      document.getElementById("imgHere").setAttribute("src", "data:image/png;base64," + text);
      document.getElementById("imageSpinner").setAttribute("class", "spinner-border d-none");
    };
    request.send()
  });

</script>


{% endblock %}
